<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Wisdom of Iroh - LambdaClass Blog</title>
    <meta name="description" content="We interview the team developing Iroh, a Rust peer-to-peer library that just works. ">

    <!-- Feeds -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://blog.lambdaclass.com/rss.xml">
    <link rel="alternate" type="application/atom+xml" title="Atom" href="https://blog.lambdaclass.com/atom.xml">

    <!-- Styles -->
    <link rel="stylesheet" href="https://blog.lambdaclass.com/style.css">

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <!-- Math rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {delimiters: [{left: '$$', right: '$$', display: true}, {left: '$', right: '$', display: false}]});"></script>
</head>
<body>
    <div class="site-wrapper">
        <header class="site-header">
            <nav class="nav-container">
                <a href="https://blog.lambdaclass.com" class="site-logo">
                    <span class="logo-text">LambdaClass</span>
                </a>
                <div class="nav-links">
                    <a href="https://blog.lambdaclass.com" >Home</a>
                    <a href="https://blog.lambdaclass.com/tags" >Topics</a>
                    <a href="https://github.com/lambdaclass" target="_blank" rel="noopener">GitHub</a>
                    <a href="https://x.com/class_lambda" target="_blank" rel="noopener">X</a>
                    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
                        <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                        <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                    </button>
                </div>
            </nav>
        </header>

        <main class="site-main">
            
<article class="page-article">
    <header class="page-header">
        <h1 class="page-title">The Wisdom of Iroh</h1>
        
        <div class="page-meta">
            <time datetime="2025-04-09">April 09, 2025</time>
        </div>
        
    </header>

    <div class="page-content prose">
        <p>As we‚Äôve written before, most of us at Lambda are internet natives. The formative experiences that made us who we are include meeting people on the other side of the world through IRC, sharing knowledge, media, and code via BitTorrent, wikipedia, and software version control systems, the birth of the first search engines, and the feeling that <em>everything</em>  was accessible. We then grew up and found frustration that this experience did not yet extend to the financial tasks needed to be an adult, and that terms like <em>walled garden</em>  better described the new state of our internet home.</p>
<p>This is why we get a double high when learning about projects like Iroh: an emotional tug from a project that enables building distributed systems in a way that gives users more agency, and a nerdy thrill from the technical challenges they‚Äôve solved to achieve it.</p>
<h2 id="what-is-it">What is it?</h2>
<p><a rel="noopener external" target="_blank" href="https://www.iroh.computer/">Iroh</a> is a distributed systems toolkit, focused on easily setting up reliable p2p connections. It includes facilities for establishing direct connections, moving data, syncing state, and pluggable application-level protocols. It‚Äôs working in production and has managed 200k concurrent connections and millions of devices on the same network with low service costs.</p>
<p>In their own words:</p>
<blockquote>
<p>Iroh is a library for establishing the most direct QUIC connection possible between two devices. Every <em>endpoint</em>  uses the public half of a cryptographic keypair to identify itself. Assuming at least one configured <em>relay server</em>  is reachable, an endpoint keeps exactly one TCP connection to a ‚Äúhome relay‚Äù that other nodes use for connection establishment, and as a fallback transport. Iroh uses a suite of <em>discovery services</em>  to resolve home relays &amp; endpoint IDs. Connections between endpoints use QUIC ALPNs to distinguish between <em>protocols</em> , while <em>routers</em>  automate the endpoint accept loop for protocol multiplexing.</p>
</blockquote>
<p>One of the things we like about Iroh is that it is clear on what it is about. It runs on QUIC, started out as a new implementation of IPFS, went through several iterations, and reduced its scope to better solve the problems they were facing. They wrote about this process in their <a rel="noopener external" target="_blank" href="https://www.iroh.computer/blog/smaller-is-better">Smaller is Better</a> and <a rel="noopener external" target="_blank" href="https://www.iroh.computer/blog/road-to-1-0">Roadmap</a> posts, and we fully agree that this is good engineering practice.</p>
<h2 id="what-can-iroh-be-used-for">What can Iroh be used for?</h2>
<p><a rel="noopener external" target="_blank" href="https://n0.computer/"><code>n0</code></a>, the company behind Iroh, keeps a <a rel="noopener external" target="_blank" href="https://github.com/n0-computer/awesome-iroh">list</a> of projects building on them but to get a quick idea, it can be of use in anything that needs file sync, p2p game streaming, distributed object storage, peer discoverability and swarm membership, local-first design, or compute job orchestration.</p>
<p>One of our partners, <a rel="noopener external" target="_blank" href="https://github.com/nousresearch">Nous Research</a> is using it in a decentralized program which relies on iroh to manage communications between nodes training LLMs, sending messages between the clients to advance the state of the network and share the gradients calculated by each node.</p>
<p>Today, we interviewed the team to get some insight.</p>
<h3 id="1-many-of-the-n0-team-members-are-ex-ipfs-or-libp2p-developers-one-of-the-first-questions-asked-is-how-iroh-compares-to-libp2p-and-as-we-understand-it-the-answer-is-related-to-having-a-tighter-focus-keeping-the-core-about-making-p2p-connections-that-just-work-and-moving-the-rest-to-application-level-protocols-such-as-iroh-gossip-blobs-and-docs-that-can-be-mixed-and-matched-as-desired-can-you-elaborate-on-this-process-and-how-reducing-scope-helped"><em>1. Many of the n0 team members are ex-IPFS or libp2p developers. One of the first questions asked is how Iroh compares to libp2p and as we understand it, the answer is related to having a tighter focus, keeping the core about making p2p connections that just work, and moving the rest to application-level protocols such as iroh-gossip, -blobs and -docs that can be mixed and matched as desired. Can you elaborate on this process and how reducing scope helped?</em></h3>
<p>b5: The process was one of slowly divesting ourselves of a lot of ‚Äúp2p project baggage‚Äù. Most p2p projects end up defaulting into a boil-the-ocean stance where they try to ship one of everything: a DHT, transports, pubsub, RPC, and over time we‚Äôve come to believe this is a big contributing factor to p2p projects feeling like half-baked prototypes. It clicked for us when our CTO dig pointed out ‚Äúno one wants the nginx team to ship postgres‚Äù. A DHT is a huge undertaking, reliable sync is a huge undertaking, reliable transports are a huge undertaking. Sometime last year we realized it just wouldn‚Äôt be possible to ship all this stuff with the team we had, so we picked the transport layer, and are focused on integrating with other projects &amp; the community forming near iroh for the things we can‚Äôt ship. Our bet is things will work better if a project like <a rel="noopener external" target="_blank" href="https://loro.dev">loro</a> ships <a rel="noopener external" target="_blank" href="https://github.com/loro-dev/iroh-loro">optional iroh support</a>, the loro team makes a truly robust CRDT, and we make a truly robust transport. There‚Äôs pressure on both teams to make the public APIs small &amp; composable, to make integration easier.<br />
A lot of this is testament to just how incredible a technical feat <code>libp2p</code> is, especially when you see the sheer number of language implementations, it‚Äôs truly impressive. But that amount of work comes with a big API surface area, makes it very challenging to port all of that functionality into a robust package that works well on a phone. It also creates the expectation that <code>libp2p</code> maintainers commit to delivering both a robust DHT <em>and</em> a reliable transport. When we more focus we explicitly mean fewer features that both work more consistently &amp; are integrated across organizations.</p>
<h3 id="2-how-did-the-decision-to-use-quic-come-about-a-few-months-ago-some-research-indicated-quic-might-have-some-downsides-and-there-seems-to-be-anecdotal-evidence-of-hostility-to-the-new-protocol-from-network-engineers-does-your-team-have-opinions-wrt-to-any-aspect-of-this-are-there-any-indications-for-iroh-adopters-that-might-stem-from-quic-usage">2. How did the decision to use QUIC come about? A few months ago some <a rel="noopener external" target="_blank" href="https://dl.acm.org/doi/10.1145/3589334.3645323">research</a> indicated QUIC might have some downsides and there seems to be anecdotal evidence of hostility to the new protocol from network engineers. Does your team have opinions wrt to any aspect of this? Are there any indications for Iroh adopters that might stem from QUIC usage?</h3>
<p>b5: the goals of QUIC closely resemble what we‚Äôre trying to do with iroh: ship new capabilities on the internet <em>with software</em>  because changing the hardware is impractical. QUIC is trying to tackle protocol ossification that set in because routers can inspect TCP headers, and doing that by dropping down to the UDP layer &amp; working from there. Along with being aligned at ‚Äúspiritual‚Äù level, things like QUIC multipath support seem almost designed for our exact use case. It‚Äôs a young technology that we‚Äôre all-in on.</p>
<p>I haven‚Äôt heard much in the way of hostility from network engineers, but I‚Äôm not entirely surprised. QUIC is intentionally trying to reduce the visible surface area to routers &amp; internet middleboxes, which I‚Äôm sure would be frustrating. I happen to be of the mind that internet middle boxes shouldn‚Äôt be messing with those packets in the first place, but hey, that‚Äôs just me üòÑ</p>
<h3 id="3-you-ve-mentioned-that-iroh-has-seen-a-million-devices-on-the-same-network-is-this-in-relation-to-the-public-iroh-relays-or-in-another-context-what-are-the-scalability-limits-you-ve-seen-and-in-which-scenarios">3. You‚Äôve mentioned that Iroh has seen a million devices on the same network. Is this in relation to the public Iroh relays or in another context? What are the scalability limits you‚Äôve seen and in which scenarios?</h3>
<p>The biggest numbers we‚Äôve seen have come from app developers deploying iroh as part of an update to an existing app. Each of those has stressed iroh in different ways. We‚Äôve shipped against those stress tests for the last 6 months. It‚Äôs by no means done, but it is giving us in-production feedback that‚Äôs critical as we work toward our 1.0 release later this year.</p>
<h3 id="4-iroh-gossip-is-particularly-interesting-as-a-modern-implementation-of-hyparview-and-plumtree-what-made-you-choose-these-protocols-have-you-done-load-tests-on-this-protocol-in-particular-what-is-your-approach-to-testing-and-load-testing-in-general">4. Iroh-gossip is particularly interesting as a modern implementation of HyParView and Plumtree. What made you choose these protocols? Have you done load tests on this protocol in particular? What is your approach to testing and load testing in general?</h3>
<p>b5: phones. If we‚Äôre going to make p2p work on a mobile devices, ‚Äústar‚Äù topologies that compensate for high network churn with lots of connections simply aren‚Äôt viable, which makes the active/passive divide in PlumTree particularly appealing. As I‚Äôm writing this someone in our discord is running a <a rel="noopener external" target="_blank" href="https://discord.com/channels/1161119546170687619/1161119546644627528/1357726363657834788">2000 node iroh gossip stress test</a> using an erlang supervisor, so yes, it‚Äôs being tested! We also have a battery of smoke &amp; simulation tests that run against the iroh gossip protocol as part of CI.<br />
Gossip has been getting more attention lately, which is driving us to put more time into it. Frando from our team has been actively working on stability as we speak.</p>
<h3 id="5-you-encourage-users-to-set-up-their-own-relays-for-their-networks-but-are-also-very-generous-with-the-three-public-ones-you-offer-aside-from-avoiding-the-rate-limits-why-use-private-relays-are-there-any-security-or-other-feature-considerations">5. You encourage users to set up their own relays for their networks but are also very generous with the three public ones you offer. Aside from avoiding the rate limits, why use private relays? Are there any security or other feature considerations?</h3>
<p>b5: It‚Äôs totally fine to use the public relays! Honestly, we‚Äôd love to see more use so we can stress them more :). As a gentle reminder for everyone: relay traffic is e2ee, so the relays can‚Äôt see traffic, but relays <em>do</em> have a list of nodeIDs, and list of connections they‚Äôre facilitating, which is privileged information. Many of our more serious users are using private relays to avoid exposing that information to the public, or even to number 0, which is things working as intended in our view. We have some plans in the works for a complimentary service that will make spinning up relays very easy. Stay tuned for that!</p>
<h3 id="6-when-developing-distributed-systems-observability-becomes-a-prime-concern-iroh-doctor-seems-like-a-cool-tool-to-have-does-iroh-offer-other-facilities-for-observing-and-debugging-its-internals-or-the-application-what-role-does-iroh-metrics-play-in-this">6. When developing distributed systems, observability becomes a prime concern. <a rel="noopener external" target="_blank" href="https://www.iroh.computer/blog/iroh-0-16-a-better-client#iroh-doctor-plot">Iroh-doctor</a> seems like a cool tool to have. Does Iroh offer other facilities for observing and debugging its internals or the application? What role does Iroh-metrics play in this?</h3>
<p>b5: We‚Äôre actively working on this. Gathering actionable network metrics in a p2p system is critical as we make p2p a mature, reliable thing. We‚Äôll have way more to say on this one in the coming months.</p>
<h3 id="7-p2p-systems-usually-disclose-the-ip-addresses-of-the-participating-nodes-and-iroh-explicitly-chooss-to-give-applications-flexibility-in-what-if-anything-to-do-in-this-regard-what-choices-do-you-see-are-usually-taken-and-what-mechanisms-aside-from-vpns-can-applications-implement">7. P2P systems usually disclose the IP addresses of the participating nodes and Iroh explicitly chooss to give applications flexibility in what (if anything) to do in this regard. What choices do you see are usually taken, and what mechanisms (aside from VPNs) can applications implement?</h3>
<p>b5: I should clarify that any connection within iroh will <em>always</em> end up exposing your IP address to the peer that you‚Äôre dialing, and the relay server your node uses as it‚Äôs home. This is also true of <em>so</em> many services you use every day, so iroh isn‚Äôt new in this regard. With that said, yeah a VPN is rarely a bad idea, and we expicitly run one-off tests between n0 staff where we start a big file transfer &amp; switch VPN on &amp; off during transfer to confirm it works (spoiler: it does).<br />
The implications of connecting users will be different for each application, but we generally ask folks to use their heads: if your app is 5-100 person invite-only chat rooms, then it makes sense to couple iroh connections with room memberships. If your app is, say, twitter, then you might need to introduce a new opt-in mechanism that makes it clear to the user that you‚Äôre disclosing something that might be abused.</p>
<h3 id="8-the-local-first-software-movement-prioritizing-user-data-being-stored-and-processed-on-their-own-devices-rather-than-relying-on-cloud-servers-is-new-and-slowly-gaining-traction-do-you-see-iroh-being-used-in-this-context-or-are-most-of-the-main-users-focused-on-other-use-cases">8. The local-first software movement (prioritizing user data being stored and processed on their own devices rather than relying on cloud servers) is new and slowly gaining traction. Do you see Iroh being used in this context or are most of the main users focused on other use cases?</h3>
<p>b5: YES. we &lt;3 local first in a big way, and think p2p is the only way to get to software that is both local first and networked. The thing user agency, p2p, and local first all have in common is shipping more capabilities to the end-user‚Äôs device than we traditionally get with today‚Äôs ‚Äúview layer on an API‚Äù apps.</p>
<h3 id="9-coupling-iroh-with-a-crdt-such-as-automerge-seems-to-be-a-common-pattern-iroh-docs-seems-geared-to-be-a-distributed-kv-store-but-is-based-on-range-based-set-reconciliation-do-you-see-these-higher-level-usage-patterns-being-codified-as-other-protocols-are-there-other-protocols-in-development-or-do-you-see-any-particular-pattern-as-a-likely-future-protocol">9. Coupling Iroh with a CRDT such as <a rel="noopener external" target="_blank" href="https://automerge.org/">automerge</a> seems to be a common pattern. Iroh-docs seems geared to be a distributed KV store but is based on range-based set reconciliation. Do you see these higher-level usage patterns being codified as other protocols? Are there other protocols in development, or do you see any particular pattern as a likely future protocol?</h3>
<p>b5: yes, iroh + automerge is definitely ‚Äúusing iroh as intended‚Äù, and you get at a good point: there are common patterns like message bootstrapping, incremental updates, and pairwise reconciliation that are commmon across a bunch of these protocols. To be able to actually have those protocols share abstractions for these patterns we‚Äôd need a more robust story for protcol composition than we currently have, because we‚Äôd need a way for a protocol to express dependencies &amp; do protocol version matching across the set of registered protocols at compilation time. Even then, it would require the buy-in from projects like automerge, which really isn‚Äôt a goal of ours right now.<br />
I think it‚Äôs going to take years, but I do think we‚Äôll get to a place where we declare a dependency graph of protocols, the compiler will be able to tell you if you have a version mismatch, and we‚Äôll be able to further decompose these patterns as a community. I‚Äôm doing some experiments in this direction on the side, but don‚Äôt expect to see anything in this department before we cut iroh 1.0.</p>
<h3 id="10-you-ve-written-about-the-challenges-of-using-async-rust-and-we-can-certainly-relate-in-our-experience-greenspun-s-tenth-rule-applies-transmuted-to-distributed-systems-sometimes-called-virding-s-rule-any-sufficiently-complicated-concurrent-program-in-another-language-contains-an-ad-hoc-informally-specified-bug-ridden-slow-implementation-of-half-of-erlang-what-is-your-experience-with-the-actor-and-message-passing-approach-both-in-rust-when-implementing-iroh-and-more-generally-when-using-iroh-to-build-systems-that-communicate">10. You‚Äôve <a rel="noopener external" target="_blank" href="https://www.iroh.computer/blog/async-rust-challenges-in-iroh">written</a> about the challenges of using async rust and we can certainly relate! In our experience Greenspun‚Äôs tenth rule applies transmuted to distributed systems (sometimes called Virding‚Äôs rule) ‚ÄúAny sufficiently complicated concurrent program in another language contains an ad hoc informally-specified bug-ridden slow implementation of half of Erlang.‚Äù What is your experience with the actor and message passing approach, both in Rust when implementing Iroh and more generally when using Iroh to build systems that communicate?</h3>
<p>b5: lol yes very much to the half-Erlang. We‚Äôre very much in that uncanny valley right now with iroh. Most of the internal guts are implemented with actors, but we haven‚Äôt formalized that into an actor abstraction, and it‚Äôs unclear that we ever will. Where that pain is felt more accutely is at the protocol level. At the level of protocol developement, it would be very nice to have easy-to-implement patterns that abstract around distibuted fault tolerance &amp; give you that ‚Äúfail whenever you want‚Äù characteristic the supervisor trees bring. The protocol dev is also at the right height in the stack, dealing with logical messages instead of raw packets.<br />
We‚Äôre still working on the groundwork of getting tutorials in place for writing a protocol in the first place, but I‚Äôd love to see us spend more time cooking up recipes for protcol development atop an actor model abstraction.</p>
<h3 id=""></h3>
<p>11. Your <a rel="noopener external" target="_blank" href="https://www.iroh.computer/roadmap">roadmap</a> is quite clear, webassembly support being oft-requested and recently merged, and better support on the way for clients wanting to use Iroh in browsers without having to send all data over relays. Some notable items in the more distant roadmap are a spec and FFI integrations. Can you elaborate on their importance and/or motivation? Do you have an estimate on when 1.0 is due and any comments on what motivates the upcoming features? What are you most excited about?</p>
<p>b5: The spec part is fun because iroh can be pretty easily expressed as a composition of existing specs, which is our plan. In our view 1.0 means you know clearly what the thing is, and how it <em>should</em> behave, so why not write that down in a spec? That said, we‚Äôre far more concerned with working software than a spec, and see taking the time to write out a spec as a means of confirming we‚Äôve considered everything we need to as part of a 1.0 push, and can communicate that consideration clearly. As for FFI bindings, we <em>really</em> , <em>really</em> want to get to languages outside of rust, but have a lot of work to do here. More on FFI in the July-August time range. Current plan for 1.0 is sometime in September.<br />
As for excitement, Divma &amp; Floris on our team have been hard at work on support for QUIC multipath for <em>months</em>. It‚Äôs a huge undertaking, and we‚Äôre all very excited to see it come together.</p>
<h3 id="12-are-there-any-bindings-or-plans-for-bindings-to-other-languages-iroh-ffi-seems-to-provide-support-for-python-what-is-it-s-status-and-do-you-plan-to-offer-official-support-for-any-other-languages">12. Are there any bindings or plans for bindings to other languages? Iroh-ffi seems to provide support for Python, what is it‚Äôs status and do you plan to offer official support for any other languages?</h3>
<p>b5: Yes, we have plans, but need to figure out some hard stuff around what basically amounts to duck-typing in UniFFI bindings first :)</p>
<p>Many thanks to the Iroh team for taking the time to answer our questions!</p>
<p>References<br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://www.iroh.computer/proto/iroh-gossip">https://www.iroh.computer/proto/iroh-gossip</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://www.bartoszsypytkowski.com/hyparview">https://www.bartoszsypytkowski.com/hyparview</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://asc.di.fct.unl.pt/~jleitao/pdf/dsn07-leitao.pdf">https://asc.di.fct.unl.pt/~jleitao/pdf/dsn07-leitao.pdf</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://www.bartoszsypytkowski.com/plumtree/">https://www.bartoszsypytkowski.com/plumtree/</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://asc.di.fct.unl.pt/~jleitao/pdf/srds07-leitao.pdf">https://asc.di.fct.unl.pt/~jleitao/pdf/srds07-leitao.pdf</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://www.iroh.computer/proto/iroh-docs">https://www.iroh.computer/proto/iroh-docs</a><br />
‚Ä¢ <a rel="noopener external" target="_blank" href="https://www.iroh.computer/proto/iroh-blobs">https://www.iroh.computer/proto/iroh-blobs</a></p>
<p><img src="https://ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif" alt="" /></p>

    </div>
</article>

        </main>

        <footer class="site-footer">
            <div class="footer-container">
                <div class="footer-content">
                    <p class="footer-copyright">&copy; 2026 LambdaClass. All rights reserved.</p>
                    <div class="footer-links">
                        <a href="https://github.com/lambdaclass" target="_blank" rel="noopener">GitHub</a>
                        <a href="https://x.com/class_lambda" target="_blank" rel="noopener">X</a>
                        <a href="https://blog.lambdaclass.com/rss.xml">RSS</a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // Theme toggle functionality
        const themeToggle = document.getElementById('theme-toggle');
        const html = document.documentElement;

        // Check for saved preference or system preference
        const savedTheme = localStorage.getItem('theme');
        const systemPrefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (savedTheme) {
            html.setAttribute('data-theme', savedTheme);
        } else if (systemPrefersDark) {
            html.setAttribute('data-theme', 'dark');
        }

        themeToggle.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        });
    </script>
</body>
</html>
